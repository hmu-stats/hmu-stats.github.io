
<!----------------->
<!--- New slide --->
<!----------------->
##
:::: {.columns}
::: {.column width="9%"}
::: {style="margin-top:-15px"}
![](images/summary.png){width=60px}
:::
:::
::: {.column width="91%"}
::: {.summary style="font-size: 28px; margin-top: 35px"}
- Bei der **Nullhypothesentestung** nach Fisher wird die Wahrscheinlichkeit geprüft, mit der ein beobachteter Effekt $\hat{\theta}$ (oder ein noch extremerer Effekt) durch Zufall entstanden sein könnte &mdash; d.h. für die Annahme dass die *Nullhypothese tatsächlich zutreffend* ist.
- Diese Wahrscheinlichkeit wird als **p-Wert** bezeichnet &mdash; je kleiner der p-Wert, desto weniger haltbar ist die Nullhypothese, desto stärker die **statistische Signifikanz**.
- Ein Effekt wird als statistisch signifikant gewertet, wenn der p-Wert unterhalb eines festgelegten **Signifikanzniveaus α** liegt (in diesem Fall wird die "Nullhypothese abgelehnt").
- Sind die Populationsstreuungen bekannt, so erfolgt die statistische Testung anhand der **Prüfgröße $z$** (**z-Wert**) in Verbindung mit der **Standardnormalverteilung**.
- Abhängig davon ob die untesuchte Hypothese **gerichtet** oder **ungerichtet** ist, erfolgt die statistische Testung entweder als **einseitiger Test** oder als **zweiseitiger Test**.
:::
:::
::::


## {.blackslide .center}

::: {.content-hidden when-format="pdf"}

![](images/paradoxia_group_of_scientists.png){.hcenter-image height=300px}

<!-- Source: Midjourney -->
<div class="vspace-small"></div>

:::

Nach kurzer Beratung in der Task Force ist Ihnen klar, dass die Voraussetzungen für einen z-Test nicht gegeben sind, da die Populationsstreuungen $\sigma$ nicht bekannt sind, sondern als $\hat{\sigma}$ geschätzt wurden. Aus Neugier rechnen Sie dennoch z-Tests für die Gruppenvergleiche und nehmen dafür an: $\sigma=\hat{\sigma}$.



## {.blackslide .center}

<div class="vspace-small"></div>

:::: {.columns}
::: {.column width="68%"}
Sie erstellen sich eine Tabelle mit den relevanten Parametern für den z-Test:

<!---  Table --->
|[TikTok]{.underline}|Fallzahl $n$ |Mittelwert $\bar{x}$|Standardabweichung $\sigma$|
|-|-|-|-|
| Kontroll | 50 | $1{,}022$ | ${0{,}545}$ |
| Paradoxia | 50 |$1{,}599$ | ${0{,}677}$ |

: {tbl-colwidths="[20, 20, 20, 33]"}

<div class="vspace-medium"></div>

<!---  Table --->
|[Entzündung]{.underline}|Fallzahl $n$ |Mittelwert $\bar{x}$|Standardabweichung $\sigma$|
|-|-|-|-|
| Kontroll | 50 | $0{,}1233$ | $0{,}0682$ |
| Paradoxia | 50 |$0{,}1477$ | $0{,}0783$ |

: {tbl-colwidths="[20, 20, 20, 33]"}

:::
::: {.column width="32%"}
::: {.content-hidden when-format="pdf"}

![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-20px !important"}

:::
:::
::::


<div class="vspace-medium"></div>

![](images/paradoxia_histogram_inflammation_mean_std.png){height=260px}


## {.blackslide .center}

<div class="vspace-small"></div>

:::: {.columns}
::: {.column width="68%"}

Um den z-Wert zu bestimmen, benötigen Sie den Standardfehler. Da es sich um unabhängige Messungen in zwei Gruppen handelt, verwenden Sie die Formel, die auf der mittleren Varianz beider Gruppen basiert:

$$
se=\sqrt{\frac{\sigma_\text{control}^2}{n_\text{control}}+\frac{\sigma_\text{paradox}^2}{n_\text{paradox}}}
$$

:::
::: {.column width="32%"}

::: {.content-hidden when-format="pdf"}

![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-20px !important"}

:::
:::
::::



Sie erhalten:

$$
\scriptsize{
\text{TikTok:}\quad\; se=\sqrt{\frac{0{,545}^2}{50}+\frac{0{,}677^2}{50}}=0{,}123\qquad \Delta\bar{x} = \bar{x}_\text{paradox} - \bar{x}_\text{control} = 1{,}599-1{,}022 = 0{,}577 \\
\text{Entzündung:}\quad\; se=\sqrt{\frac{0{,}0682^2}{50}+\frac{0{,}0783^2}{50}}=0{,}0147\qquad \Delta\bar{x} = \bar{x}_\text{paradox} - \bar{x}_\text{control} = 0{,}1477-0{,}1233 = 0{,}0243
}
$$


## {.blackslide .center}

<div class="vspace-small"></div>

:::: {.columns}
::: {.column width="68%"}
Der z-Wert ergibt sich als das Verhältnis aus dem "Effekt" (hier $\Delta\bar{x}$) und dem Standardfehler:

$$
\text{TikTok:}\qquad z=\frac{\hat{\theta}}{se}=\frac{\Delta\bar{x}}{se} = \frac{0{,}577}{0{,}123} = 4{,}69\\
\text{Entzündung:}\qquad z=\frac{\hat{\theta}}{se}=\frac{\Delta\bar{x}}{se} = \frac{0{,}0243}{0{,}0147} = 1{,}65
$$

:::
::: {.column width="32%"}
::: {.content-hidden when-format="pdf"}
![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-20px !important"}

:::
:::
::::

:::: {.columns}
::: {.column width="60%"}
In beiden Fällen haben Sie eine **gerichtete** Hypothese, nämlich dass Pardoxiker höhere Werte als Kontrollen aufweisen. Der p-Wert entspricht also der Fläche unter der Standardnormalverteilung *rechts* vom z-Wert und damit dem Integral:

$$
p=\int_{z}^{\infty}\varphi(x)dx = 1 - \Phi(z)
$$
:::
::: {.column width="40%"}

![](images/paradoxia_nulldist.png)

:::
::::





## {.blackslide .center}

<div class="vspace-small"></div>

:::: {.columns}
::: {.column width="68%"}

Die Spannung steigt, als Sie nun zum ersten Mal die Signifikanz Ihrer Ergebnisse beurteilen können. Sie erhalten folgende p-Werte:

<div class="vspace-small"></div>

$$
\text{TikTok:}\qquad p= 1 - \Phi(4{,}69) \overset{\text{(Computer)}}{=} 0{,}000001
$$

<div class="vspace-small"></div>

$$
\text{Entzündung:}\qquad p= 1 - \Phi(1{,}67) \overset{\text{(Computer)}}{=} 0{,}049
$$

:::
::: {.column width="32%"}
::: {.content-hidden when-format="pdf"}
![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-20px !important"}

:::
:::
::::


Dieser erste Signifikanztest ergibt also, dass die TikTok-Hypothese mit überwältigender Signifikanz bestätigt wird. Aber auch die Entzündungs-Hypothese wird mit einem p-Wert von $0{,}049$  &mdash; und einem Signifikanzniveau von $\alpha=0{,}05$ &mdash; um Haaresbreite bestätigt. 

Noch genießen Sie die Ergebnisse aber mit Vorsicht, da Ihnen bewusst ist, dass der z-Test nicht der ideale Test für Ihre Studie ist.


## {.blackslide .center}

<div class="vspace-small"></div>

:::: {.columns}
::: {.column width="68%"}

Sie aktualisieren vorläufig Ihre vorherige Abbildung in zweierlei Hinsicht:

:::{.nonincremental}
- Sie ersetzen die Standardabweichung durch den Standardfehler. Dieser legt die Betonung auf den Effekt der Sie interessiert: den Unterschied der [Mittelwerte]{.underline}.
- Sie fügen Signifikanzsternchen ein. Eine gängige Notation ist ein Sternchen (\*) für p-Werte kleiner 0,05, zwei Sternchen (\*\*) für p-Werte kleiner 0,01 und drei Sternchen (\*\*\*) für p-Werte kleiner 0,001.
:::

:::
::: {.column width="32%"}
::: {.content-hidden when-format="pdf"}
![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-20px !important"}

:::
:::
::::

![](images/paradoxia_histogram_inflammation_sem_sig.png){height=290px style="margin-top: 30px !important;"}

<!-- ```{python}
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import os
from scipy.stats import sem
import seaborn as sns

np.random.seed(0)
root = '/home/matteo/OneDrive/lehre/Statistik/stats1_lecture/book/'

fontsize = 15

df = pd.read_csv(os.path.join(root, 'data', 'paradoxia.csv'))
# print(df.head())

data_tiktok_control = df[df.group == 1]['hours_tiktok_per_day'].values
data_tiktok_paradoxia = df[df.group == 2]['hours_tiktok_per_day'].values
data_inflam_control = df[df.group == 1]['inflammation'].values
data_inflam_paradoxia = df[df.group == 2]['inflammation'].values

print(f'Mean TikTok Control: {np.mean(data_tiktok_control):.2f}')
print(f'Mean TikTok Paradoxia: {np.mean(data_tiktok_paradoxia):.2f}')
print(f'Mean Inflam Control: {np.mean(data_inflam_control):.2f}')
print(f'Mean Inflam Paradoxia: {np.mean(data_inflam_paradoxia):.2f}')

plt.style.use('dark_background')
plt.figure(figsize=(6, 2.5))
ax = plt.subplot(121)
plt.gca().set_facecolor('#eee')
sns.stripplot(data=df, x='group', y='hours_tiktok_per_day', color='#bbb', jitter=0.25)
color = 'k'
plt.errorbar([0], [np.mean(data_tiktok_control)], yerr=[sem(data_tiktok_control)], fmt='o', markersize=4, capsize=10, capthick=1.5, elinewidth=1.5, ecolor=color, mfc=color, mec=color, zorder=3)
plt.errorbar([1], [np.mean(data_tiktok_paradoxia)], yerr=[sem(data_tiktok_paradoxia)], fmt='o', markersize=4, capsize=10, capthick=1.5, elinewidth=1.5, ecolor=color, mfc=color, mec=color, zorder=3)
plt.text(0.25, 0.85, r'$\bar{x}=' + f'{np.mean(data_tiktok_control):.2f}$'.replace('.', '{,}'), ha='center', color='k', fontsize=fontsize-1, transform=ax.transAxes)
plt.text(0.75, 0.85, r'$\bar{x}=' + f'{np.mean(data_tiktok_paradoxia):.2f}$'.replace('.', '{,}'), ha='center', color='k', fontsize=fontsize-1, transform=ax.transAxes)
plt.plot([0, 1], [2.4, 2.4], 'k-', lw=2, zorder=4)
plt.text(0.5, 2.32, '***', ha='center', va='center', fontsize=15, color='k', backgroundcolor='#eee', zorder=5)

plt.xticks([0, 1], ['Kontroll', 'Paradoxia'], fontsize=fontsize)
plt.yticks(fontsize=fontsize-2)
plt.ylabel('Stunden TikTok / 24h', fontsize=fontsize)
plt.xlabel('')
# plt.xlim(-0.5, 1.5)
plt.ylim(0, 1.1*max(data_tiktok_control.max(), data_tiktok_paradoxia.max()))


ax = plt.subplot(122)
plt.gca().set_facecolor('#eee')
sns.stripplot(data=df, x='group', y='inflammation', color='#bbb', jitter=0.25)
color = 'k'
plt.errorbar([0], [np.mean(data_inflam_control)], yerr=[sem(data_inflam_control)], fmt='o', markersize=4, capsize=10, capthick=1.5, elinewidth=1.5, ecolor=color, mfc=color, mec=color, zorder=3)
plt.errorbar([1], [np.mean(data_inflam_paradoxia)], yerr=[sem(data_inflam_paradoxia)], fmt='o', markersize=4, capsize=10, capthick=1.5, elinewidth=1.5, ecolor=color, mfc=color, mec=color, zorder=3)
plt.text(0.25, 0.85, r'$\bar{x}=' + f'{np.mean(data_inflam_control):.2f}$'.replace('.', '{,}'), ha='center', color='k', fontsize=fontsize-1, transform=ax.transAxes)
plt.text(0.75, 0.85, r'$\bar{x}=' + f'{np.mean(data_inflam_paradoxia):.2f}$'.replace('.', '{,}'), ha='center', color='k', fontsize=fontsize-1, transform=ax.transAxes)
plt.plot([0, 1], [0.25, 0.25], 'k-', lw=2, zorder=4)
plt.text(0.5, 0.24, '*', ha='center', va='center', fontsize=15, color='k', backgroundcolor='#eee', zorder=5)

plt.xticks([0, 1], ['Kontroll', 'Paradoxia'], fontsize=fontsize)
plt.yticks(fontsize=fontsize-2)
plt.ylabel('Entzündungswert', fontsize=fontsize)
plt.xlabel('')
plt.xlim(-0.5, 1.5)
plt.ylim(0, 1.1*max(data_inflam_control.max(), data_inflam_paradoxia.max()))


plt.tight_layout()

plt.savefig('images/paradoxia_histogram_inflammation_sem_sig.png', bbox_inches='tight')
``` -->
