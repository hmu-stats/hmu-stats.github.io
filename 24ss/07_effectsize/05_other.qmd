# Weitere Effektmaße




<!----------------->
<!--- New slide --->
<!----------------->
## Weitere Effektmaße

:::{.nonincremental}
- Im Bereich klinischer Studien finden sich weitere Effektmaße, die in der Regel zum Ziel haben, die Wirksamkeit einer Intervention (Behandlung) zu quantifizieren.
- Folgende drei Effektmaße aus diesem Kontext betrachten wir:
    - Absolute Risikoreduktion (ARR)
    - Numbers Needed to Treat (NNT)
    - Odds ratio (OR)
:::

<div class="vspace-large"></div>    

![](images/clinical_effect_sizes.png){height=300px}

<!----------------->
<!--- New slide --->
<!----------------->
## Absolute Risikoreduktion (ARR)

Sind beide Variablen dichotom, sind weder der Korrelationskoeffizient noch Cohen's d intuitive Effektmaße. 

<!---  Example --->
::: {.example}
|||
|:-:|-|
| ![](images/example.png){height=70px} | Sie untersuchen, ob ein neues Medikament die Heilungsrate (Erfolgsrate) einer Krankheit verbessert. Die Treatmentgruppe erhält das Medikament, die Kontrollgruppe Placebo.
: {tbl-colwidths="[10, 90]"}
:::

Eine sinnnvolles Effektmaß ist hier, *um wie viel* die Erfolgsrate in der Treatmentgruppe die Erfolgsrate in der Kontrollgruppe übersteigt. Dies lässt sich einfach aus einer Vierfeldertafel ableiten:

:::: {.columns}
::: {.column width="50%"}
![](images/vierfeldertafel.png)
:::
::: {.column width="50%"}
![](images/arr.png)

:::
::::

:::{.nonincremental}
- $ARR$ ist die [**Absolute Risikoreduktion**]{color="navy"}.
:::

<!----------------->
<!--- New slide --->
<!----------------->
## Numbers Needed to Treat (NNT)

:::{.nonincremental}
- Noch gängiger als die Absolute Risikoreduktion ist die inverse Größe, die als [**Numbers Needed to Treat (NNT)**]{color="navy"} bezeichnet wird.
:::

::: {.definition}
<!---  Definition--->
|||
|:-:|-|
|||
| ![](images/definition.svg){height=70px} | **Number Needed to Treat:** Anzahl der Personen, die behandelt werden müssten, damit eine zusätzliche Person einen Nutzen hat. | 
|||
: {tbl-colwidths="[10, 90]"}

:::

Mathematisch ist $NNT$ das Inverse der $ARR$:

$$
NNT = \frac{1}{ARR}
$$

:::{.nonincremental}
- Da es um Personen geht, wird die NNT immer aufgerundet.
:::

<!---  Example --->
::: {.example style="border-width: 0 !important"}
||||
|:-:|-|-|
||||
| ![](images/example.png){height=60px} | ![](images/vierfeldertafel_numbers.png) | $ARR = \frac{90}{90+10} - \frac{35}{35+35}=0{,}9-0{,}5=0{,}4\quad\rightarrow\quad NRR=\frac{1}{0{,}4}=2{,}5$ \
&rArr; Drei weitere Personen müssten behandelt werden, damit eine zusätzliche Person einen Nutzen hat (d.h. die andernfalls nicht geheilt würde).|
||||
: {tbl-colwidths="[10, 30, 60]"}

:::



<!----------------->
<!--- New slide --->
<!----------------->
## Odds Ratio (OR)

:::{.nonincremental}
- Das [**Odds Ratio**]{color="navy"} ($OR$) vergleicht das *Heilerfolgsverhältnis in der Treatmentgruppe* zum *Heilerfolgsverhältnis in der Kontrollgruppe*:
:::

:::: {.columns}
::: {.column width="50%"}
![](images/vierfeldertafel.png)

:::
::: {.column width="50%"}
$$
\text{OR} = \frac{\frac{A}{B}}{\frac{C}{D}} = \frac{A\cdot C}{B\cdot D}
$$

[Beachte: Als Heilerfolgsverhältnis wird hier das Verhältnis der Zahl der geheilten Patienten gegenüber der Zahl der nicht geheilten Patienten verstanden.]{style="font-size: 20px; line-height: 1.05 !important; display: block; margin-top: 40px; color:#777"}

:::
::::

- Hat das Treatment keine Auswirkung, so sind die Heilerfolgsverhältnisse in beiden Gruppen gleich, d.h. $OR=1$.
- Ist das Treatment erfolgreich, ist das Heilerfolgsverhältnis in der Treatmentgruppen höher als in der Kontrollgruppe, d.h. $OR>1$.
- Ist das Treatment sogar nachteilig, ist das Heilerfolgsverhältnis in der Treatmentgruppen *kleiner* als in der Kontrollgruppe, d.h. $OR<1$.




<!----------------->
<!--- New slide --->
<!----------------->
## ARR, NNT, OR: Caveat

:::{.nonincremental}
- Auch wenn das Ziel der Effektmaße $ARR$, $NNT$, $OR$ eine einfache laienverständliche Kommunikation der Treatmenteffizienz ist, darf angezweifelt werden, ob dies immer der Fall ist, wie durch folgendes Beispiel demonstriert^[Andrade C (2015) The Numbers Needed to Treat and Harm (NNT, NNH) Statistics: What They Tell Us and What They Do Not: (Practical Psychopharmacology). J Clin Psychiatry 76:e330–e333.
]:
:::

![](images/quote_NNT.png)

:::{.nonincremental}
- Hinweis: $ARR$ und $OR$ haben das gleiche Problem.
:::



## Zusammenfassung: Übersicht Effektmaße {.nonincremental}

<div class="vspace-medium"></div>

![](images/overview_effectsizes.png){height=600px}


<!----------------->
<!--- New slide --->
<!----------------->
##
:::: {.columns}
::: {.column width="9%"}
::: {style="margin-top:-15px"}
![](images/summary.png){width=60px}
:::
:::
::: {.column width="91%"}
::: {.summary}
- Die praktische Signifikanz von Effekten wird als [**Effektstärke**]{color="navy"} bezeichnet.
- Effektstärken sind **standardisierte einheitslose Maße**, die **zwischen Studien verglichen** werden können.
- Während **Korrelationskoeffizienten bereits standardisiert** sind, müssen **Mittelwertsunterschiede** erst in standardisierte Effektmaße überführt werden: **Cohend's d**.
- Die Berechnung von Cohen's d hängt ab vom Design ab: Standardisierung mit der **Differenzenvarianz** bei abhängigen Messungen und mit der **gepoolten Varianz** bei unabhängigen Messungen.
- Im medizinischen Kontext sind weitere Effekmaße geläufig: absolute Risikoreduktion (ARR), Numbers Needed to Treat (NNT) und Odds Ratio (OR).
:::
:::
::::



<!-- ```{python}
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import os
import seaborn as sns

np.random.seed(0)
root = '/home/matteo/OneDrive/lehre/Statistik/stats1_lecture/book/'

fontsize = 15
color = 'k'

N = 50

df = pd.read_csv(os.path.join(root, 'data', 'paradoxia.csv'))
# print(df.head())

data_tiktok_control = df[df.group == 1]['hours_tiktok_per_day'].values
data_tiktok_paradoxia = df[df.group == 2]['hours_tiktok_per_day'].values
data_inflam_control = df[df.group == 1]['inflammation'].values
data_inflam_paradoxia = df[df.group == 2]['inflammation'].values

d_tiktok = (np.mean(data_tiktok_paradoxia) - np.mean(data_tiktok_control)) / np.sqrt((np.var(data_tiktok_paradoxia)+np.var(data_tiktok_control))/(2*(1-1/N)))
d_inflam = (np.mean(data_inflam_paradoxia) - np.mean(data_inflam_control)) / np.sqrt((np.var(data_inflam_paradoxia)+np.var(data_inflam_control))/(2*(1-1/N)))

# Formula from https://stats.stackexchange.com/questions/495015/what-is-the-formula-for-the-standard-error-of-cohens-d
d_se_tiktok = (8+d_tiktok**2)/(4*N)
d_se_inflam = (8+d_inflam**2)/(4*N)

plt.style.use('dark_background')
plt.figure(figsize=(3, 2.5))
plt.gca().set_facecolor('#eee')
plt.errorbar([0], [d_tiktok], yerr=[d_se_tiktok], fmt='o', markersize=4, capsize=10, capthick=2, elinewidth=2, ecolor=color, mfc=color, mec=color, zorder=3)
plt.errorbar([1], [d_inflam], yerr=[d_se_inflam], fmt='o', markersize=4, capsize=10, capthick=2, elinewidth=2, ecolor=color, mfc=color, mec=color, zorder=3)
plt.text(0, 0.07, r'$d=' + f'{d_tiktok:.2f}'.replace('.', '{,}') + '$', ha='center', color='k', fontsize=fontsize-2)
plt.text(1, 0.07, r'$d=' + f'{d_inflam:.2f}'.replace('.', '{,}') + '$', ha='center', color='k', fontsize=fontsize-2)

plt.xticks([0, 1], ['TikTok', 'Entzündung'], fontsize=fontsize)
plt.yticks(fontsize=fontsize-2)
plt.ylabel("Cohen's $d$", fontsize=fontsize)
plt.xlabel('')
plt.xlim(-0.5, 1.5)
plt.ylim(0, 1.6)
plt.grid(True, color='#e2e2e2')


plt.savefig('images/paradoxia_cohensd.png', bbox_inches='tight')

``` -->

## {.blackslide .center}

<div class="vspace-medium"></div>

:::: {.columns}
::: {.column width="65%"}
Sie berechnen nun Cohen's d für die beiden Gruppenunterschiede hinsichtlich der TikTok-Zeit und Entzündungswerte:
:::
::: {.column width="35%"}
::: {.content-hidden when-format="pdf"}
![](images/paradoxia_group_of_scientists.png){.hcenter-image height=200px style="margin-top:-100px !important"}
<!-- Source: Midjourney -->

:::
:::
::::

:::: {.columns}
::: {.column width="70%"}
<div class="vspace-large"></div>
![](images/paradoxia_cohensd.png){height=300px}
:::
::: {.column width="30%"}
::: {.caption-style style="margin-top:250px !important; margin-left:-180px"}
Hinweis: in der Abbildung wurde nicht nur die Effektstärke selbst aufgetragen, sondern auch ein Streuungsmaß der Effektstärke (Standardfehler der Effektstärke). Dazu kommen wir in Vorlesung 08.
:::
:::
::::

Langsam schärft sich das Bild: während die Entzündungswerte höchstens eine mittlere Effektstärke aufweisen ($d=0{,}33$), ist der TikTok-Effekt beeindruckend groß: $\;d=0{,}93$.